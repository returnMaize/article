# 2.寻找Vue的入口

在阅读 Vue 源码前，我们必须要先找到 Vue 的入口，然后顺藤摸瓜的方式摸清 Vue 的整体轮廓，之后便是细节上的各个突破。<br />找到一个源码入口最好的方式便是 package.json 文件<br />![image.png](https://cdn.nlark.com/yuque/0/2020/png/1532057/1594694872043-dfe1df1e-ad24-42f8-8b9e-4f2e366214cf.png#align=left&display=inline&height=272&margin=%5Bobject%20Object%5D&name=image.png&originHeight=272&originWidth=764&size=20836&status=done&style=none&width=764)<br />module 对应的文件是 ESM 规范的包，main 对应的文件是 server 端的包。这里你可以理解为我们平时使用 Vue 开发项目时（也就是通过 import 方式引入Vue），引入的文件就是 module 对应的文件 dist/vue.runtime.esm.js 而我们在 node 环境下使用 Vue 引入的文件就是 main 对应的文件 dist/vue.runtime.common.js。如果想要了解更多可以阅读 [npm 文档](https://docs.npmjs.com/files/package.json)<br />虽然现在我们已经知道了我们平时开发时引入的文件，但是这个文件是已经构建（打包）完成的文件，我们不可能阅读这个文件里的代码来了解 Vue 的原理，我们需要通过它找出 Vue 构建之前的入口，我们同样来到 package.json 文件<br />![image.png](https://cdn.nlark.com/yuque/0/2020/png/1532057/1594694088606-46c8da16-f113-444b-b8d5-68bbbbb33ba4.png#align=left&display=inline&height=382&margin=%5Bobject%20Object%5D&name=image.png&originHeight=382&originWidth=762&size=45226&status=done&style=none&width=762)<br />通过 package.json 文件我们很快就能找到构建 Vue 的配置文件的入口在 script/build.js 文件下，然后我们打开 script/build.js 文件<br />![image.png](https://cdn.nlark.com/yuque/0/2020/png/1532057/1594694463209-0add6ccc-d9c2-4d49-80ae-bf892462aa05.png#align=left&display=inline&height=907&margin=%5Bobject%20Object%5D&name=image.png&originHeight=907&originWidth=829&size=61567&status=done&style=none&width=829)<br />可以看到 script/build.js 的代码结构也非常的清晰，下面定义函数，上面执行代码。首先 Vue 通过 getAllBuilds() 拿到了所有的配置，然后通过命令行过滤掉不需要的配置，最后通过 build() 构建Vue。简单阅读之后我们很快就可以定位到构建配置代码都放在了 config.js 文件中<br />![image.png](https://cdn.nlark.com/yuque/0/2020/png/1532057/1594695785846-4dc8d6b0-12f3-4a70-b11c-106a64c1f798.png#align=left&display=inline&height=159&margin=%5Bobject%20Object%5D&name=image.png&originHeight=159&originWidth=482&size=11882&status=done&style=none&width=482)<br />通过配置我立刻知道了 Vue 的入口在 web/entry-runtime.js 文件下，细心的朋友可能已经发现在与 dist 齐平的目录下并没有名叫 web 的文件夹，这是因为 resolve() 方法，这里的 web/entry-runtime.js 实际上对应的是 **src/platforms/web/entry-runtime.js** 文件。对 resolve() 实现感兴趣的朋友可以细看一下它的代码，这里我们就不看其中细节了<br />
<br />**阅读源码技巧：**先明确一个目标。例如：本章目标是找到 Vue 的入口。然后开始朝这个目标前进，过程中并不细看方法的实现（除非迫不得已），可以看到我们在寻找入口期间并没有具体去看一些方法的实现，比如 getAllBuilds() build() resolve()等。因为这并不影响我们实现目标，相反，如果你太纠结于每一个方法的实现，会导致你失去目标，最后看了半天都不知道自己干嘛。这里并不是说我们不看这些方法的实现，只是方式不对，我们可以先完成目标，比如找到了 Vue 的入口，然后又对某个方法的实现特别感兴趣，这个时候你在去看具体的代码实现，这才是我们阅读源码的正确姿态。